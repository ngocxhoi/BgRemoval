<template>
  <div class="flex items-center justify-between py-3">
    <NuxtLink to="/" id="logoNav">
      <svg
        viewBox="0 0 370.00000000000006 60.61805555555556"
        class="h-auto w-40 sm:w-44 md:w-52"
      >
        <defs id="SvgjsDefs2013"></defs>
        <g
          id="SvgjsG2014"
          featurekey="G09qjj-0"
          transform="matrix(0.7777777777777778,0,0,0.7777777777777778,-3.888888888888889,-8.57986111111111)"
          fill="#550c55"
        >
          <path
            xmlns="http://www.w3.org/2000/svg"
            style="
              text-indent: 0;
              text-transform: none;
              direction: ltr;
              enable-background: accumulate;
            "
            d="M 50 11.03125 L 48.375 13.84375 L 44.65625 20.3125 L 44.125 21.25 L 44.65625 22.1875 L 70.40625 66.78125 L 46.75 66.78125 L 45.65625 66.78125 L 45.125 67.71875 L 41.40625 74.21875 L 39.78125 77 L 43 77 L 84.875 77.03125 L 88.09375 77 L 86.46875 74.1875 L 51.625 13.84375 L 50 11.03125 z M 43.09375 23 L 41.46875 25.8125 L 6.625 86.1875 L 5 88.96875 L 8.25 88.96875 L 15.71875 88.96875 L 16.8125 88.96875 L 17.34375 88.03125 L 43.09375 43.4375 L 54.9375 63.90625 L 55.4375 64.84375 L 56.53125 64.84375 L 64 64.84375 L 67.25 64.84375 L 65.625 62.0625 L 44.71875 25.8125 L 43.09375 23 z M 42.96875 47.125 L 41.375 49.9375 L 20.4375 86.15625 L 18.8125 88.96875 L 22.0625 88.96875 L 91.78125 88.96875 L 95 88.96875 L 93.375 86.15625 L 89.65625 79.6875 L 89.09375 78.75 L 88.03125 78.75 L 36.53125 78.75 L 48.34375 58.28125 L 48.875 57.34375 L 48.34375 56.40625 L 44.59375 49.9375 L 42.96875 47.125 z "
            fill="#550c55"
            fill-opacity="1"
            fill-rule="nonzero"
            stroke="none"
            marker="none"
            visibility="visible"
            display="inline"
            overflow="visible"
          ></path>
        </g>
        <g
          id="SvgjsG2015"
          featurekey="0yvIkK-0"
          transform="matrix(2.6430056042276964,0,0,2.6430056042276964,84.87256897656428,-8.897867651099146)"
          fill="#550c55"
        >
          <path
            d="M6.38 18.8 q1.7 0 2.6 -0.73 t0.9 -1.99 q0 -1.36 -0.93 -2.14 t-2.43 -0.78 l-3.26 0 l0 5.64 l3.12 0 z M6.08 11.96 q1.44 0 2.31 -0.62 t0.87 -1.76 q0 -2.48 -3 -2.54 l-3 0 l0 4.92 l2.82 0 z M6.12 5.84 q2.22 0 3.33 0.9 t1.13 2.84 q0 1.12 -0.66 1.91 t-1.88 1.03 l0 0.04 q1.38 0.08 2.26 1.04 t0.9 2.44 q0 1.88 -1.25 2.91 t-3.45 1.05 l-4.56 0 l0 -14.16 l4.18 0 z M15 15.26 q0 1.52 1.07 2.57 t2.59 1.09 q1.5 0 2.56 -1.06 t1.1 -2.6 q0 -1.52 -1.08 -2.58 t-2.6 -1.08 q-1.52 0 -2.58 1.09 t-1.06 2.57 z M18.74 10.52 q2.36 0.02 3.5 1.8 l0.04 0 l0 -1.56 l1.2 0 l0 8.6 q0 2.7 -1.3 4.07 t-3.64 1.37 q-1.4 0 -2.62 -0.51 t-1.94 -1.43 l0.94 -0.88 q1.24 1.74 3.64 1.74 q3.72 0 3.72 -4.14 l0 -1.38 l-0.04 0 q-1.12 1.76 -3.5 1.8 q-2 0 -3.44 -1.37 t-1.5 -3.37 q0 -1.96 1.47 -3.34 t3.47 -1.4 z M27.42 18.2 q0.4 0 0.68 0.28 t0.28 0.68 t-0.28 0.68 t-0.68 0.28 t-0.68 -0.28 t-0.28 -0.68 t0.28 -0.68 t0.68 -0.28 z M36.18 12.08 q1.54 0 2.38 -0.69 t0.84 -1.83 t-0.82 -1.82 t-2.44 -0.7 l-2.86 0 l0 5.04 l2.9 0 z M35.78 5.84 q4.9 0 4.94 3.72 q0 3.14 -3.62 3.64 l4.12 6.8 l-1.5 0 l-3.98 -6.72 l-2.46 0 l0 6.72 l-1.32 0 l0 -14.16 l3.82 0 z M50.72 14.6 q0 -1.26 -0.94 -2.13 t-2.28 -0.87 q-1.3 0 -2.24 0.87 t-1.1 2.13 l6.56 0 z M47.58 10.52 q1.92 0 3.12 1.24 t1.22 3.2 l0 0.72 l-7.76 0 q0.08 1.56 1.03 2.51 t2.47 0.97 q0.94 0 1.79 -0.45 t1.31 -1.19 l0.88 0.74 q-1.3 1.98 -4 1.98 q-2.12 -0.02 -3.39 -1.38 t-1.29 -3.5 q0 -2.08 1.31 -3.45 t3.31 -1.39 z M59 10.52 q1.02 0 1.75 0.52 t1.03 1.48 q0.4 -0.96 1.26 -1.48 t1.9 -0.52 q3.5 0 3.5 3.92 l0 5.56 l-1.2 0 l0 -5.5 q0 -2.88 -2.32 -2.9 q-1.4 0 -2.1 0.92 t-0.7 2.38 l0 5.1 l-1.2 0 l0 -5.62 q0 -1.26 -0.48 -2.01 t-1.46 -0.77 q-1.44 0 -2.3 1.01 t-0.88 2.81 l0 4.58 l-1.2 0 l0 -6.74 q-0.02 -0.68 -0.1 -2.5 l1.2 0 q0.04 1.48 0.08 1.62 l0.06 0 q0.4 -0.86 1.28 -1.36 t1.88 -0.5 z M72.32 15.379999999999999 q0 1.66 1.04 2.72 t2.62 1.06 q1.64 0 2.65 -1.08 t1.01 -2.7 q0 -1.6 -1 -2.68 t-2.68 -1.1 q-1.62 0 -2.62 1.08 t-1.02 2.7 z M75.97999999999999 10.52 q2.12 0 3.48 1.38 t1.38 3.48 q0 2.14 -1.39 3.49 t-3.47 1.37 q-2.18 -0.02 -3.51 -1.4 t-1.35 -3.46 q0 -2.14 1.37 -3.49 t3.49 -1.37 z M83.57999999999998 10.76 l3.08 7.94 l3 -7.94 l1.22 0 l-3.64 9.24 l-1.24 0 l-3.78 -9.24 l1.36 0 z M94.77999999999999 15.04 l6.5 0 l-3.2 -7.76 z M98.82 5.84 l5.96 14.16 l-1.48 0 l-1.54 -3.76 l-7.5 0 l-1.6 3.76 l-1.38 0 l6.18 -14.16 l1.36 0 z M106.67999999999999 4.880000000000001 l1.2 0 l0 15.12 l-1.2 0 l0 -15.12 z"
          ></path>
        </g>
      </svg>
    </NuxtLink>

    <div class="flex items-center gap-4">
      <ColorSwitch />
      <template v-if="status === 'authenticated'">
        <div class="flex items-center gap-4">
          <button
            class="hidden sm:flex items-center gap-2 bg-blue-100 dark:bg-gray-400 px-4 sm:px-7 py-2.5 rounded-full"
          >
            <img src="/images/coin.png" class="w-5" alt="coin-image" />
            <p
              class="text-xs text-gray-600 dark:text-white sm:text-sm font-medium"
            >
              Credit: {{ data?.user?.creditBalance }}
            </p>
          </button>

          <p class="text-gray-500 dark:text-white hidden sm:block">
            Hi,
            <span v-if="data?.user?.username || data?.user?.name">
              {{ data.user.username ?? data.user.name }}</span
            >
            <span v-else> User</span>
          </p>

          <UDropdown
            :items="items"
            :ui="{ item: { disabled: 'cursor-text select-text' } }"
            :popper="{
              arrow: true,
              offsetDistance: 20,
              placement: 'bottom-end',
            }"
            class="[&>*]:!transition-none"
          >
            <UAvatar
              :src="
                data?.user?.image ??
                data?.user?.picture ??
                '/images/user-placeholder.png'
              "
            />

            <template #account="{ item }">
              <div class="text-left">
                <p>Signed in as</p>
                <p class="truncate font-medium text-gray-900 dark:text-white">
                  {{ data?.user?.email }}
                </p>
              </div>
            </template>
          </UDropdown>
        </div>
      </template>

      <template v-else>
        <UButton
          to="/login"
          trailing-icon="i-heroicons-arrow-right"
          size="lg"
          color="black"
          label="Get Started"
          class="rounded-full"
        />
      </template>
    </div>
  </div>
</template>

<script lang="ts" setup>
const { status, data, signOut } = useAuth();

const items = [
  [
    {
      label: "Email",
      slot: "account",
      disabled: true,
    },
  ],
  [
    {
      label: "Settings",
      icon: "i-heroicons-cog-8-tooth",
    },
  ],
  [
    {
      label: "Profile",
      icon: "i-heroicons-user-circle",
      click: () => navigateTo("/profile"),
    },
  ],
  [
    {
      label: "Sign out",
      icon: "i-heroicons-arrow-left-on-rectangle",
      click: async () => {
        await signOut({ callbackUrl: "/login" });
      },
    },
  ],
];
</script>
